<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Barrelfish: include/dist/start.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Barrelfish
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_47a103fa4a37a699861f60c70c0a68ed.html">dist</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">start.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Startup code for distributed services.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab0c19ed17dd813812f68308f0246e1f6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="start_8h.html#ab0c19ed17dd813812f68308f0246e1f6">dist_main</a> (struct dist_args *d_args, void *m_args, char *name)</td></tr>
<tr class="memdesc:ab0c19ed17dd813812f68308f0246e1f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main function that starts work for master and worker dispatchers.  <a href="#ab0c19ed17dd813812f68308f0246e1f6">More...</a><br /></td></tr>
<tr class="separator:ab0c19ed17dd813812f68308f0246e1f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad986f6268d6ad862df029067575a5e68"><td class="memItemLeft" align="right" valign="top">errval_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="start_8h.html#ad986f6268d6ad862df029067575a5e68">worker_args</a> (void *m_args, char **res[], int *res_len)</td></tr>
<tr class="memdesc:ad986f6268d6ad862df029067575a5e68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Externally defined function to convert service-specific arguments.  <a href="#ad986f6268d6ad862df029067575a5e68">More...</a><br /></td></tr>
<tr class="separator:ad986f6268d6ad862df029067575a5e68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45eb542a9050a18416d079122e99c99c"><td class="memItemLeft" align="right" valign="top">errval_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="start_8h.html#a45eb542a9050a18416d079122e99c99c">run_master</a> (coreid_t core, coreid_t *cores, int cores_len, void *m_args, char *name)</td></tr>
<tr class="memdesc:a45eb542a9050a18416d079122e99c99c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Externally defined function providing service specific master functionality.  <a href="#a45eb542a9050a18416d079122e99c99c">More...</a><br /></td></tr>
<tr class="separator:a45eb542a9050a18416d079122e99c99c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa41ba545ed119310b9628fbe3821f662"><td class="memItemLeft" align="right" valign="top">errval_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="start_8h.html#aa41ba545ed119310b9628fbe3821f662">run_worker</a> (coreid_t core, coreid_t *cores, int cores_len, void *m_args, char *name)</td></tr>
<tr class="memdesc:aa41ba545ed119310b9628fbe3821f662"><td class="mdescLeft">&#160;</td><td class="mdescRight">Externally defined function providing service-specific worker functionality.  <a href="#aa41ba545ed119310b9628fbe3821f662">More...</a><br /></td></tr>
<tr class="separator:aa41ba545ed119310b9628fbe3821f662"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Startup code for distributed services. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ab0c19ed17dd813812f68308f0246e1f6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dist_main </td>
          <td>(</td>
          <td class="paramtype">struct dist_args *&#160;</td>
          <td class="paramname"><em>d_args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m_args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main function that starts work for master and worker dispatchers. </p>
<p>Depending on the arguments passed in d_args-&gt;master this function starts a dispatcher running as a master or a worker. As a master it spwans worker dispatchers on the given cores (d_args-&gt;cores) and then calls the externally defined <a class="el" href="start_8h.html#a45eb542a9050a18416d079122e99c99c" title="Externally defined function providing service specific master functionality. ">run_master()</a> function. As a worker it calls the externally defined <a class="el" href="start_8h.html#aa41ba545ed119310b9628fbe3821f662" title="Externally defined function providing service-specific worker functionality. ">run_worker()</a> function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d_args</td><td>the generic distributed service arguments passed to this dispatcher. </td></tr>
    <tr><td class="paramname">m_args</td><td>the service-specific arguments passed to this dispatcher. </td></tr>
    <tr><td class="paramname">name</td><td>the name of this service. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>an exit value (main() should return this value). </dd></dl>

</div>
</div>
<a class="anchor" id="a45eb542a9050a18416d079122e99c99c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">errval_t run_master </td>
          <td>(</td>
          <td class="paramtype">coreid_t&#160;</td>
          <td class="paramname"><em>core</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">coreid_t *&#160;</td>
          <td class="paramname"><em>cores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cores_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m_args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Externally defined function providing service specific master functionality. </p>
<p>This function is run after all the workers have been succesfully spawned. In most cases this function won't do much, since the master's main task is to spawn workers and then coordinate their startup.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">core</td><td>core ID of this dispatcher. </td></tr>
    <tr><td class="paramname">cores</td><td>a list of the cores that the workers run on. </td></tr>
    <tr><td class="paramname">cores_len</td><td>the length of the list. </td></tr>
    <tr><td class="paramname">m_args</td><td>the service-specific arguments passed to this dispatcher. </td></tr>
    <tr><td class="paramname">name</td><td>the name of this service. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>success or error code. </dd></dl>

</div>
</div>
<a class="anchor" id="aa41ba545ed119310b9628fbe3821f662"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">errval_t run_worker </td>
          <td>(</td>
          <td class="paramtype">coreid_t&#160;</td>
          <td class="paramname"><em>core</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">coreid_t *&#160;</td>
          <td class="paramname"><em>cores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cores_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m_args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Externally defined function providing service-specific worker functionality. </p>
<p>This function is run by every worker dispatcher when it is started. This is the main service-specific entry point. In most cases this function never returns but starts an infinite dispatch loop.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">core</td><td>core ID of this dispatcher. </td></tr>
    <tr><td class="paramname">cores</td><td>a list of the cores that the workers run on. </td></tr>
    <tr><td class="paramname">cores_len</td><td>the length of the list. </td></tr>
    <tr><td class="paramname">m_args</td><td>the service-specific arguments passed to this dispatcher. </td></tr>
    <tr><td class="paramname">name</td><td>the name of this service. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>success or error code. </dd></dl>

</div>
</div>
<a class="anchor" id="ad986f6268d6ad862df029067575a5e68"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">errval_t worker_args </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>m_args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>res</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>res_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Externally defined function to convert service-specific arguments. </p>
<p>This function must return an array of command line arguments, representing those in m_args, that can be passed to a worker dispatcher when it is spawned by a master.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m_args</td><td>the service-specific arguments passed to this dispatcher. </td></tr>
    <tr><td class="paramname">res</td><td>returns a list of command line arguments (like argv). This is malloced by this function, the caller must free it. </td></tr>
    <tr><td class="paramname">res_len</td><td>returns the number of elements in the res list </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>success or error code. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
