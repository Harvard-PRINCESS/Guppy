<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Barrelfish: include/barrelfish/lmp_chan.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Barrelfish
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_d4e97a57a2af26ed01adfb3ccd13c638.html">barrelfish</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">lmp_chan.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Bidirectional LMP channel.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlmp__chan.html">lmp_chan</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A bidirectional LMP channel.  <a href="structlmp__chan.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2d05032ce7ecb557d3e561bd4c943f4c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmp__chan_8h.html#a2d05032ce7ecb557d3e561bd4c943f4c">lmp_chan_init</a> (struct <a class="el" href="structlmp__chan.html">lmp_chan</a> *lc)</td></tr>
<tr class="memdesc:a2d05032ce7ecb557d3e561bd4c943f4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise a new LMP channel.  <a href="#a2d05032ce7ecb557d3e561bd4c943f4c">More...</a><br /></td></tr>
<tr class="separator:a2d05032ce7ecb557d3e561bd4c943f4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab73046fe71a9d86ed2fd55d579bbb371"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab73046fe71a9d86ed2fd55d579bbb371"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmp__chan_8h.html#ab73046fe71a9d86ed2fd55d579bbb371">lmp_chan_destroy</a> (struct <a class="el" href="structlmp__chan.html">lmp_chan</a> *lc)</td></tr>
<tr class="memdesc:ab73046fe71a9d86ed2fd55d579bbb371"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy the local state associated with a given channel. <br /></td></tr>
<tr class="separator:ab73046fe71a9d86ed2fd55d579bbb371"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73f7fddbf0f65417c910b344950f3c3b"><td class="memItemLeft" align="right" valign="top">errval_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmp__chan_8h.html#a73f7fddbf0f65417c910b344950f3c3b">lmp_chan_bind</a> (struct <a class="el" href="structlmp__chan.html">lmp_chan</a> *lc, struct lmp_bind_continuation cont, struct event_queue_node *qnode, iref_t iref, size_t buflen_words)</td></tr>
<tr class="memdesc:a73f7fddbf0f65417c910b344950f3c3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise a new LMP channel and initiate a binding.  <a href="#a73f7fddbf0f65417c910b344950f3c3b">More...</a><br /></td></tr>
<tr class="separator:a73f7fddbf0f65417c910b344950f3c3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad84553ba416f4edf6f78ae360d2da648"><td class="memItemLeft" align="right" valign="top">errval_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmp__chan_8h.html#ad84553ba416f4edf6f78ae360d2da648">lmp_chan_accept</a> (struct <a class="el" href="structlmp__chan.html">lmp_chan</a> *lc, size_t buflen_words, struct <a class="el" href="structcapref.html">capref</a> endpoint)</td></tr>
<tr class="memdesc:ad84553ba416f4edf6f78ae360d2da648"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise a new LMP channel to accept an incoming binding request.  <a href="#ad84553ba416f4edf6f78ae360d2da648">More...</a><br /></td></tr>
<tr class="separator:ad84553ba416f4edf6f78ae360d2da648"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a239dbf8b2f8e135a7b4193b9f976b3ac"><td class="memItemLeft" align="right" valign="top">errval_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmp__chan_8h.html#a239dbf8b2f8e135a7b4193b9f976b3ac">lmp_chan_register_send</a> (struct <a class="el" href="structlmp__chan.html">lmp_chan</a> *lc, struct <a class="el" href="structwaitset.html">waitset</a> *ws, struct event_closure closure)</td></tr>
<tr class="memdesc:a239dbf8b2f8e135a7b4193b9f976b3ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register an event handler to be notified when messages can be sent.  <a href="#a239dbf8b2f8e135a7b4193b9f976b3ac">More...</a><br /></td></tr>
<tr class="separator:a239dbf8b2f8e135a7b4193b9f976b3ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa320570916847b9b3f1f2fdf58bf9342"><td class="memItemLeft" align="right" valign="top">errval_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmp__chan_8h.html#aa320570916847b9b3f1f2fdf58bf9342">lmp_chan_deregister_send</a> (struct <a class="el" href="structlmp__chan.html">lmp_chan</a> *lc)</td></tr>
<tr class="memdesc:aa320570916847b9b3f1f2fdf58bf9342"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancel an event registration made with <a class="el" href="lmp__chan_8c.html#a239dbf8b2f8e135a7b4193b9f976b3ac" title="Register an event handler to be notified when messages can be sent. ">lmp_chan_register_send()</a>  <a href="#aa320570916847b9b3f1f2fdf58bf9342">More...</a><br /></td></tr>
<tr class="separator:aa320570916847b9b3f1f2fdf58bf9342"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab796a0af7a15d02b2097694c371a43f9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmp__chan_8h.html#ab796a0af7a15d02b2097694c371a43f9">lmp_chan_migrate_send</a> (struct <a class="el" href="structlmp__chan.html">lmp_chan</a> *lc, struct <a class="el" href="structwaitset.html">waitset</a> *ws)</td></tr>
<tr class="memdesc:ab796a0af7a15d02b2097694c371a43f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Migrate an event registration to a new waitset.  <a href="#ab796a0af7a15d02b2097694c371a43f9">More...</a><br /></td></tr>
<tr class="separator:ab796a0af7a15d02b2097694c371a43f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8d1122c695103ff2425fed0aed4bb42"><td class="memItemLeft" align="right" valign="top">errval_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmp__chan_8h.html#ab8d1122c695103ff2425fed0aed4bb42">lmp_chan_alloc_recv_slot</a> (struct <a class="el" href="structlmp__chan.html">lmp_chan</a> *lc)</td></tr>
<tr class="memdesc:ab8d1122c695103ff2425fed0aed4bb42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a new receive capability slot for an LMP channel.  <a href="#ab8d1122c695103ff2425fed0aed4bb42">More...</a><br /></td></tr>
<tr class="separator:ab8d1122c695103ff2425fed0aed4bb42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac859e9a2f8610009c88a31319087f785"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmp__chan_8h.html#ac859e9a2f8610009c88a31319087f785">lmp_channels_retry_send_disabled</a> (dispatcher_handle_t handle)</td></tr>
<tr class="memdesc:ac859e9a2f8610009c88a31319087f785"><td class="mdescLeft">&#160;</td><td class="mdescRight">Trigger send events for all LMP channels that are registered.  <a href="#ac859e9a2f8610009c88a31319087f785">More...</a><br /></td></tr>
<tr class="separator:ac859e9a2f8610009c88a31319087f785"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a8dfd0969399f8e2d9a52f2984576d6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5a8dfd0969399f8e2d9a52f2984576d6"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmp__chan_8h.html#a5a8dfd0969399f8e2d9a52f2984576d6">lmp_init</a> (void)</td></tr>
<tr class="memdesc:a5a8dfd0969399f8e2d9a52f2984576d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the LMP channel driver. <br /></td></tr>
<tr class="separator:a5a8dfd0969399f8e2d9a52f2984576d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Bidirectional LMP channel. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ad84553ba416f4edf6f78ae360d2da648"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">errval_t lmp_chan_accept </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlmp__chan.html">lmp_chan</a> *&#160;</td>
          <td class="paramname"><em>lc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>buflen_words</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcapref.html">capref</a>&#160;</td>
          <td class="paramname"><em>endpoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise a new LMP channel to accept an incoming binding request. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lc</td><td>Storage for channel state </td></tr>
    <tr><td class="paramname">buflen_words</td><td>Size of incoming buffer, in words </td></tr>
    <tr><td class="paramname">endpoint</td><td>Capability to remote LMP endpoint </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab8d1122c695103ff2425fed0aed4bb42"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">errval_t lmp_chan_alloc_recv_slot </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlmp__chan.html">lmp_chan</a> *&#160;</td>
          <td class="paramname"><em>lc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate a new receive capability slot for an LMP channel. </p>
<p>This utility function allocates a new receive slot (using <a class="el" href="barrelfish_2slot__alloc_2slot__alloc_8c.html#aa2eb3aa1a4dec9f0b042a2cf926b805a" title="Default slot allocator. ">slot_alloc</a>) and sets it on the channel (using #lmp_chan_set_recv_slot).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lc</td><td>LMP channel </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a73f7fddbf0f65417c910b344950f3c3b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">errval_t lmp_chan_bind </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlmp__chan.html">lmp_chan</a> *&#160;</td>
          <td class="paramname"><em>lc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct lmp_bind_continuation&#160;</td>
          <td class="paramname"><em>cont</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct event_queue_node *&#160;</td>
          <td class="paramname"><em>qnode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">iref_t&#160;</td>
          <td class="paramname"><em>iref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>buflen_words</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise a new LMP channel and initiate a binding. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lc</td><td>Storage for channel state </td></tr>
    <tr><td class="paramname">cont</td><td>Continuation for bind completion/failure </td></tr>
    <tr><td class="paramname">qnode</td><td>Storage for an event queue node (used for queuing bind request) </td></tr>
    <tr><td class="paramname">iref</td><td>IREF to which to bind </td></tr>
    <tr><td class="paramname">buflen_words</td><td>Size of incoming buffer, in number of words </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa320570916847b9b3f1f2fdf58bf9342"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">errval_t lmp_chan_deregister_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlmp__chan.html">lmp_chan</a> *&#160;</td>
          <td class="paramname"><em>lc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cancel an event registration made with <a class="el" href="lmp__chan_8c.html#a239dbf8b2f8e135a7b4193b9f976b3ac" title="Register an event handler to be notified when messages can be sent. ">lmp_chan_register_send()</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lc</td><td>LMP channel </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2d05032ce7ecb557d3e561bd4c943f4c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lmp_chan_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlmp__chan.html">lmp_chan</a> *&#160;</td>
          <td class="paramname"><em>lc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise a new LMP channel. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lc</td><td>Storage for channel state </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab796a0af7a15d02b2097694c371a43f9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lmp_chan_migrate_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlmp__chan.html">lmp_chan</a> *&#160;</td>
          <td class="paramname"><em>lc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structwaitset.html">waitset</a> *&#160;</td>
          <td class="paramname"><em>ws</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Migrate an event registration to a new waitset. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lc</td><td>LMP channel </td></tr>
    <tr><td class="paramname">ws</td><td>New waitset to migrate to </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a239dbf8b2f8e135a7b4193b9f976b3ac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">errval_t lmp_chan_register_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlmp__chan.html">lmp_chan</a> *&#160;</td>
          <td class="paramname"><em>lc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structwaitset.html">waitset</a> *&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct event_closure&#160;</td>
          <td class="paramname"><em>closure</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register an event handler to be notified when messages can be sent. </p>
<p>In the future, call the closure on the given waitset when it is likely that a message can be sent on the channel. A channel may only be registered with a single send event handler on a single waitset at any one time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lc</td><td>LMP channel </td></tr>
    <tr><td class="paramname">ws</td><td>Waitset </td></tr>
    <tr><td class="paramname">closure</td><td>Event handler </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac859e9a2f8610009c88a31319087f785"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lmp_channels_retry_send_disabled </td>
          <td>(</td>
          <td class="paramtype">dispatcher_handle_t&#160;</td>
          <td class="paramname"><em>handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Trigger send events for all LMP channels that are registered. </p>
<p>We don't have a good way to determine when we are likely to be able to send on an LMP channel, so this function just trigger all such pending events every time the dispatcher is rescheduled.</p>
<p>Must be called while disabled and from dispatcher logic. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
