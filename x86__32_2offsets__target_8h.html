<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Barrelfish: kernel/include/target/x86_32/offsets_target.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Barrelfish
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_dc43877d82dd332f9fb2071fcca799d6.html">kernel</a></li><li class="navelem"><a class="el" href="dir_009f605b833ac4622acd6c3c0c26c0f0.html">include</a></li><li class="navelem"><a class="el" href="dir_891a2dd2d9ba19829dc14c879b117587.html">target</a></li><li class="navelem"><a class="el" href="dir_52144243b2c2dc74b9dd51658d30bdfe.html">x86_32</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">offsets_target.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>X86-32 address space sizes and offsets.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad5f32c5942d9bc02019b83b18bef1d48"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x86__32_2offsets__target_8h.html#ad5f32c5942d9bc02019b83b18bef1d48">X86_32_VADDR_SPACE_SIZE</a>&#160;&#160;&#160;((genpaddr_t)1 &lt;&lt; 32)</td></tr>
<tr class="separator:ad5f32c5942d9bc02019b83b18bef1d48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4970cd94a4d7a4db9f1739c4a984ac5c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x86__32_2offsets__target_8h.html#a4970cd94a4d7a4db9f1739c4a984ac5c">X86_32_PADDR_SPACE_SIZE</a>&#160;&#160;&#160;((genpaddr_t)1 &lt;&lt; 32)</td></tr>
<tr class="separator:a4970cd94a4d7a4db9f1739c4a984ac5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a618b3d5c63ceb7e8ca9d8e81b08aea42"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x86__32_2offsets__target_8h.html#a618b3d5c63ceb7e8ca9d8e81b08aea42">X86_32_START_KERNEL_PHYS</a>&#160;&#160;&#160;0x100000</td></tr>
<tr class="separator:a618b3d5c63ceb7e8ca9d8e81b08aea42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae11d7357515e4b4a795632c91ad023a2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x86__32_2offsets__target_8h.html#ae11d7357515e4b4a795632c91ad023a2">X86_32_PADDR_SPACE_LIMIT</a>&#160;&#160;&#160;((genpaddr_t)1 &lt;&lt; 31)</td></tr>
<tr class="separator:ae11d7357515e4b4a795632c91ad023a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad237259757c2deebfa09fb64a21d87a0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x86__32_2offsets__target_8h.html#ad237259757c2deebfa09fb64a21d87a0">X86_32_DEVICE_SPACE_LIMIT</a>&#160;&#160;&#160;(1 * <a class="el" href="x86__32_2paging__kernel__arch_8h.html#a976340e2ac334c174563a9ed8d40de12">X86_32_MEM_PAGE_SIZE</a>)</td></tr>
<tr class="separator:ad237259757c2deebfa09fb64a21d87a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41e4e0610a6d5b21f4a0738dd7918875"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x86__32_2offsets__target_8h.html#a41e4e0610a6d5b21f4a0738dd7918875">X86_32_INIT_SPACE_LIMIT</a>&#160;&#160;&#160;(32 * 1024 * 1024)</td></tr>
<tr class="separator:a41e4e0610a6d5b21f4a0738dd7918875"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae206cc1c745528b93e276b6a55519630"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x86__32_2offsets__target_8h.html#ae206cc1c745528b93e276b6a55519630">X86_32_PDE_ALIGN</a>(addr)&#160;&#160;&#160;((addr) &amp; ~(((genpaddr_t)1 &lt;&lt; 22) - 1))</td></tr>
<tr class="separator:ae206cc1c745528b93e276b6a55519630"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf014673574003dfd5c2d645cc11426d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x86__32_2offsets__target_8h.html#aaf014673574003dfd5c2d645cc11426d">X86_32_MEMORY_OFFSET</a>&#160;&#160;&#160;<a class="el" href="x86__32_2offsets__target_8h.html#ae206cc1c745528b93e276b6a55519630">X86_32_PDE_ALIGN</a>((genpaddr_t)2 * 1024 * 1024 * 1024)</td></tr>
<tr class="separator:aaf014673574003dfd5c2d645cc11426d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad77dcfa199d48f4a33bae2dd34a15930"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x86__32_2offsets__target_8h.html#ad77dcfa199d48f4a33bae2dd34a15930">X86_32_KERNEL_STACK_SIZE</a>&#160;&#160;&#160;0x4000</td></tr>
<tr class="separator:ad77dcfa199d48f4a33bae2dd34a15930"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5c1cda098b3b464d3743ec15038f7bc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x86__32_2offsets__target_8h.html#ac5c1cda098b3b464d3743ec15038f7bc">X86_32_REAL_MODE_SEGMENT</a>&#160;&#160;&#160;0x0600</td></tr>
<tr class="separator:ac5c1cda098b3b464d3743ec15038f7bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a570f692bcd4013754d67c368f0d25687"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x86__32_2offsets__target_8h.html#a570f692bcd4013754d67c368f0d25687">X86_32_REAL_MODE_OFFSET</a>&#160;&#160;&#160;0x0000</td></tr>
<tr class="separator:a570f692bcd4013754d67c368f0d25687"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2e908d2c888b78eb45a34aa49601a4c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x86__32_2offsets__target_8h.html#ac2e908d2c888b78eb45a34aa49601a4c">X86_32_REAL_MODE_LINEAR_OFFSET</a>&#160;&#160;&#160;(<a class="el" href="x86__32_2offsets__target_8h.html#ac5c1cda098b3b464d3743ec15038f7bc">X86_32_REAL_MODE_SEGMENT</a> &lt;&lt; 4)</td></tr>
<tr class="separator:ac2e908d2c888b78eb45a34aa49601a4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6640274c6e031629fe7f8d6bf6df2c21"><td class="memItemLeft" align="right" valign="top">uintptr_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x86__32_2offsets__target_8h.html#a6640274c6e031629fe7f8d6bf6df2c21">x86_32_kernel_stack</a> [<a class="el" href="x86__32_2offsets__target_8h.html#ad77dcfa199d48f4a33bae2dd34a15930">X86_32_KERNEL_STACK_SIZE</a>/sizeof(uintptr_t)]</td></tr>
<tr class="memdesc:a6640274c6e031629fe7f8d6bf6df2c21"><td class="mdescLeft">&#160;</td><td class="mdescRight">The kernel stack.  <a href="#a6640274c6e031629fe7f8d6bf6df2c21">More...</a><br /></td></tr>
<tr class="separator:a6640274c6e031629fe7f8d6bf6df2c21"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>X86-32 address space sizes and offsets. </p>
<p>The layout of the x86-32 virtual address space can be summarized as follows:</p>
<pre>
 +--------------------------------+------------------------------------+
 | User-space                     | Physical memory                    |
 | PDPTE entries: 0 1             | PDPTE entries: 2 3                 |
 +--------------------------------+------------------------------------+</pre><p>User-space maps user-space programs. Physical memory maps all available physical memory (up to PADDR_SPACE_LIMIT).</p>
<p>This partition is static and can only be changed at compile-time. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ad237259757c2deebfa09fb64a21d87a0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define X86_32_DEVICE_SPACE_LIMIT&#160;&#160;&#160;(1 * <a class="el" href="x86__32_2paging__kernel__arch_8h.html#a976340e2ac334c174563a9ed8d40de12">X86_32_MEM_PAGE_SIZE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Maximum device address space mappable by the kernel. Adjust this for a bigger device address space. We set this to one page, so the APIC driver can do its job. </p>

</div>
</div>
<a class="anchor" id="a41e4e0610a6d5b21f4a0738dd7918875"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define X86_32_INIT_SPACE_LIMIT&#160;&#160;&#160;(32 * 1024 * 1024)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Static virtual address space limit for the init user-space domain. init's virtual address space always starts at address zero. The static space is used to map in code and static data of the init module, as well as all loaded multiboot modules, the dispatcher frame and bootinfo structure. init can freely allocate dynamic memory as soon as it is running. This is 32 MBytes right now.</p>
<p>You should make this constant a multiple of #BASE_PAGE_SIZE * #PTABLE_SIZE or you'll restrict init's static address space unneccessarily. init's lowest segment should also be based at these multiples or it restricts itself. </p>

</div>
</div>
<a class="anchor" id="ad77dcfa199d48f4a33bae2dd34a15930"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define X86_32_KERNEL_STACK_SIZE&#160;&#160;&#160;0x4000</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Kernel stack size &ndash; 16KB </p>

</div>
</div>
<a class="anchor" id="aaf014673574003dfd5c2d645cc11426d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define X86_32_MEMORY_OFFSET&#160;&#160;&#160;<a class="el" href="x86__32_2offsets__target_8h.html#ae206cc1c745528b93e276b6a55519630">X86_32_PDE_ALIGN</a>((genpaddr_t)2 * 1024 * 1024 * 1024)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Absolute offset of mapped physical memory within virtual address space. This occupies one or more PDE slots directly before the kernel. This needs to be aligned to PADDR_SPACE_LIMIT. </p>

</div>
</div>
<a class="anchor" id="ae11d7357515e4b4a795632c91ad023a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define X86_32_PADDR_SPACE_LIMIT&#160;&#160;&#160;((genpaddr_t)1 &lt;&lt; 31)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Maximum physical address space mappable by the kernel. Adjust this for a bigger physical address space. We set this to 32-bit, i.e. 4 GBytes. </p>

</div>
</div>
<a class="anchor" id="a4970cd94a4d7a4db9f1739c4a984ac5c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define X86_32_PADDR_SPACE_SIZE&#160;&#160;&#160;((genpaddr_t)1 &lt;&lt; 32)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Absolute size of physical address space. This is 48-bit. </p>

</div>
</div>
<a class="anchor" id="ae206cc1c745528b93e276b6a55519630"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define X86_32_PDE_ALIGN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">addr</td><td>)</td>
          <td>&#160;&#160;&#160;((addr) &amp; ~(((genpaddr_t)1 &lt;&lt; 22) - 1))</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Aligns an address to the nearest PDE entry by masking out lower 21 bits. </p>

</div>
</div>
<a class="anchor" id="ac2e908d2c888b78eb45a34aa49601a4c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define X86_32_REAL_MODE_LINEAR_OFFSET&#160;&#160;&#160;(<a class="el" href="x86__32_2offsets__target_8h.html#ac5c1cda098b3b464d3743ec15038f7bc">X86_32_REAL_MODE_SEGMENT</a> &lt;&lt; 4)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The linear offset of the real-mode segment </p>

</div>
</div>
<a class="anchor" id="a570f692bcd4013754d67c368f0d25687"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define X86_32_REAL_MODE_OFFSET&#160;&#160;&#160;0x0000</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The real-mode offset <em>has to be</em> 0000!! </p>

</div>
</div>
<a class="anchor" id="ac5c1cda098b3b464d3743ec15038f7bc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define X86_32_REAL_MODE_SEGMENT&#160;&#160;&#160;0x0600</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The real-mode addressesThe real-mode segment </p>

</div>
</div>
<a class="anchor" id="a618b3d5c63ceb7e8ca9d8e81b08aea42"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define X86_32_START_KERNEL_PHYS&#160;&#160;&#160;0x100000</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Start address of kernel image in physical memory. This is passed to the linker also. The bootloader will load us there. </p>

</div>
</div>
<a class="anchor" id="ad5f32c5942d9bc02019b83b18bef1d48"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define X86_32_VADDR_SPACE_SIZE&#160;&#160;&#160;((genpaddr_t)1 &lt;&lt; 32)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Absolute size of virtual address space. This is 32-bit on x86-32, which equals 4 GBytes and allows for 1024 PDE slots, each of which can map 4 MBytes. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a6640274c6e031629fe7f8d6bf6df2c21"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uintptr_t x86_32_kernel_stack[<a class="el" href="x86__32_2offsets__target_8h.html#ad77dcfa199d48f4a33bae2dd34a15930">X86_32_KERNEL_STACK_SIZE</a>/sizeof(uintptr_t)]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The kernel stack. </p>
<p>The kernel stack.</p>
<p>This is the one and only kernel stack for a kernel instance. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
