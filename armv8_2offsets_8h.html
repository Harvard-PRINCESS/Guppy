<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Barrelfish: kernel/include/arch/armv8/offsets.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Barrelfish
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_dc43877d82dd332f9fb2071fcca799d6.html">kernel</a></li><li class="navelem"><a class="el" href="dir_009f605b833ac4622acd6c3c0c26c0f0.html">include</a></li><li class="navelem"><a class="el" href="dir_b938bbc65f66dd090a6a00a71c65b7d8.html">arch</a></li><li class="navelem"><a class="el" href="dir_1c411a18e64d2835cf2453ac4f4642a7.html">armv8</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">offsets.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>ARMv8 address-space sizes and offsets.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a42f32052642dc485bf2761f6f6d7c70c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv8_2offsets_8h.html#a42f32052642dc485bf2761f6f6d7c70c">VADDR_SPACE_SIZE_BITS</a>&#160;&#160;&#160;48</td></tr>
<tr class="separator:a42f32052642dc485bf2761f6f6d7c70c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a376f6c696e851d2c9420a786941bb7a7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv8_2offsets_8h.html#a376f6c696e851d2c9420a786941bb7a7">PADDR_SPACE_SIZE_BITS</a>&#160;&#160;&#160;48</td></tr>
<tr class="separator:a376f6c696e851d2c9420a786941bb7a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbd92b7b671b2162770dcf094f5a34fa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv8_2offsets_8h.html#abbd92b7b671b2162770dcf094f5a34fa">START_KERNEL_PHYS</a>&#160;&#160;&#160;0x80000000</td></tr>
<tr class="separator:abbd92b7b671b2162770dcf094f5a34fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55d0c3475cc452ccbd6e0c8dd1c68bd7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv8_2offsets_8h.html#a55d0c3475cc452ccbd6e0c8dd1c68bd7">KERNEL_OFFSET</a>&#160;&#160;&#160;0xffff000000000000ULL</td></tr>
<tr class="separator:a55d0c3475cc452ccbd6e0c8dd1c68bd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40c0ab0a0a092f7fd208481a82cb5cf8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv8_2offsets_8h.html#a40c0ab0a0a092f7fd208481a82cb5cf8">PADDR_SPACE_LIMIT</a>&#160;&#160;&#160;(<a class="el" href="armv7_2offsets_8h.html#aaffaca57c7c58481e0360343694a3231">GEN_ADDR</a>(49) - 1)</td></tr>
<tr class="separator:a40c0ab0a0a092f7fd208481a82cb5cf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94ea8b5f1d54a3db01c9df21ebba0c1a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv8_2offsets_8h.html#a94ea8b5f1d54a3db01c9df21ebba0c1a">ARMV8_INIT_SPACE_LIMIT</a>&#160;&#160;&#160;(32 * 1024 * 1024)</td></tr>
<tr class="separator:a94ea8b5f1d54a3db01c9df21ebba0c1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a939e27227f0b26aae7c5a420df2dbc2e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv8_2offsets_8h.html#a939e27227f0b26aae7c5a420df2dbc2e">ARMV8_INIT_VBASE</a>&#160;&#160;&#160;(2 * 1024 * 1024)</td></tr>
<tr class="separator:a939e27227f0b26aae7c5a420df2dbc2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6de30a7372a6e758a79c361d0ee2618"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv8_2offsets_8h.html#ab6de30a7372a6e758a79c361d0ee2618">MEMORY_OFFSET</a>&#160;&#160;&#160;(<a class="el" href="armv8_2offsets_8h.html#a55d0c3475cc452ccbd6e0c8dd1c68bd7">KERNEL_OFFSET</a>)</td></tr>
<tr class="separator:ab6de30a7372a6e758a79c361d0ee2618"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c087877c06676d8dab3e80a07fb3b62"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv8_2offsets_8h.html#a8c087877c06676d8dab3e80a07fb3b62">PHYS_MEMORY_START</a>&#160;&#160;&#160;0x0</td></tr>
<tr class="separator:a8c087877c06676d8dab3e80a07fb3b62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77383d4c5311d4c7fe49364766887650"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv8_2offsets_8h.html#a77383d4c5311d4c7fe49364766887650">KERNEL_STACK_SIZE</a>&#160;&#160;&#160;0x4000</td></tr>
<tr class="separator:a77383d4c5311d4c7fe49364766887650"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1625a96d10b72c2eb4227f48cdc64fce"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv8_2offsets_8h.html#a1625a96d10b72c2eb4227f48cdc64fce">KERNEL_IMAGE_SIZE</a></td></tr>
<tr class="separator:a1625a96d10b72c2eb4227f48cdc64fce"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab2b724236109f0e557bf2f9193c62696"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv8_2offsets_8h.html#ab2b724236109f0e557bf2f9193c62696">kernel_first_byte</a></td></tr>
<tr class="separator:ab2b724236109f0e557bf2f9193c62696"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcbac8bf86dc4f0699f9329a0d3ed35f"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv8_2offsets_8h.html#abcbac8bf86dc4f0699f9329a0d3ed35f">kernel_text_final_byte</a></td></tr>
<tr class="separator:abcbac8bf86dc4f0699f9329a0d3ed35f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1b7975530599a83d19018b5c39393ef"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv8_2offsets_8h.html#ad1b7975530599a83d19018b5c39393ef">kernel_final_byte</a></td></tr>
<tr class="separator:ad1b7975530599a83d19018b5c39393ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf78a61c4caab267d02668ea46a903ce"><td class="memItemLeft" align="right" valign="top">uintptr_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv8_2offsets_8h.html#acf78a61c4caab267d02668ea46a903ce">kernel_stack</a></td></tr>
<tr class="memdesc:acf78a61c4caab267d02668ea46a903ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">The kernel stack.  <a href="#acf78a61c4caab267d02668ea46a903ce">More...</a><br /></td></tr>
<tr class="separator:acf78a61c4caab267d02668ea46a903ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>ARMv8 address-space sizes and offsets. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a94ea8b5f1d54a3db01c9df21ebba0c1a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ARMV8_INIT_SPACE_LIMIT&#160;&#160;&#160;(32 * 1024 * 1024)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Static address space limit for the init user-space domain. The static space is used to map in code and static data of the init module, as well as all loaded multiboot modules. init can freely allocate dynamic memory as soon as it is running. This is 32 MBytes right now.</p>
<p>You should make this constant a multiple of #BASE_PAGE_SIZE * #PTABLE_SIZE or you'll restrict init's static address space unneccessarily. init's lowest segment should also be based at these multiples or it restricts itself. </p>

</div>
</div>
<a class="anchor" id="a939e27227f0b26aae7c5a420df2dbc2e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ARMV8_INIT_VBASE&#160;&#160;&#160;(2 * 1024 * 1024)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Base address of init address space in virtual memory. init should start at 4 MByte. The kernel maps in important structures at 2 MByte. This address should be page-table size aligned (i.e. with 4 KByte pages, a page table maps 2 MBytes. Thus, align it to multiples of 2 MBytes). </p>

</div>
</div>
<a class="anchor" id="a1625a96d10b72c2eb4227f48cdc64fce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KERNEL_IMAGE_SIZE</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">(size_t)(&amp;<a class="code" href="armv7_2offsets_8h.html#ad1b7975530599a83d19018b5c39393ef">kernel_final_byte</a> - \</div><div class="line">                                         &amp;<a class="code" href="armv7_2offsets_8h.html#ab2b724236109f0e557bf2f9193c62696">kernel_first_byte</a>)</div><div class="ttc" id="armv7_2offsets_8h_html_ad1b7975530599a83d19018b5c39393ef"><div class="ttname"><a href="armv7_2offsets_8h.html#ad1b7975530599a83d19018b5c39393ef">kernel_final_byte</a></div><div class="ttdeci">uint8_t kernel_final_byte</div></div>
<div class="ttc" id="armv7_2offsets_8h_html_ab2b724236109f0e557bf2f9193c62696"><div class="ttname"><a href="armv7_2offsets_8h.html#ab2b724236109f0e557bf2f9193c62696">kernel_first_byte</a></div><div class="ttdeci">uint8_t kernel_first_byte</div></div>
</div><!-- fragment --><p>The size of the whole kernel image. </p>

</div>
</div>
<a class="anchor" id="a55d0c3475cc452ccbd6e0c8dd1c68bd7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KERNEL_OFFSET&#160;&#160;&#160;0xffff000000000000ULL</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Kernel offset - virtual base of the kernel's address space: the region mapped by TTBR1. </p>

</div>
</div>
<a class="anchor" id="a77383d4c5311d4c7fe49364766887650"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KERNEL_STACK_SIZE&#160;&#160;&#160;0x4000</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Kernel stack size &ndash; 16KB </p>

</div>
</div>
<a class="anchor" id="ab6de30a7372a6e758a79c361d0ee2618"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MEMORY_OFFSET&#160;&#160;&#160;(<a class="el" href="armv8_2offsets_8h.html#a55d0c3475cc452ccbd6e0c8dd1c68bd7">KERNEL_OFFSET</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The absolute base address of mapped physical memory, within the kernel's virtual address space. </p>

</div>
</div>
<a class="anchor" id="a40c0ab0a0a092f7fd208481a82cb5cf8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PADDR_SPACE_LIMIT&#160;&#160;&#160;(<a class="el" href="armv7_2offsets_8h.html#aaffaca57c7c58481e0360343694a3231">GEN_ADDR</a>(49) - 1)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Maximum physical address space mappable by the kernel. Adjust this for a bigger physical address space. </p>

</div>
</div>
<a class="anchor" id="a376f6c696e851d2c9420a786941bb7a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PADDR_SPACE_SIZE_BITS&#160;&#160;&#160;48</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Absolute size of physical address space. Depends on value in ID_AA64MMFR0_EL1 (ARMv8-A TRM, D4-1733) current options are 4G, 64G, 1T, 4T, 16T, 256T set to 256T for now </p>

</div>
</div>
<a class="anchor" id="a8c087877c06676d8dab3e80a07fb3b62"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PHYS_MEMORY_START&#160;&#160;&#160;0x0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Absolute start of RAM in physical memory. XXX - this isn't statically known. </p>

</div>
</div>
<a class="anchor" id="abbd92b7b671b2162770dcf094f5a34fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define START_KERNEL_PHYS&#160;&#160;&#160;0x80000000</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Start address of kernel image in physical memory. Most ARM platforms have the first physical window starting at 2GB. </p>

</div>
</div>
<a class="anchor" id="a42f32052642dc485bf2761f6f6d7c70c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VADDR_SPACE_SIZE_BITS&#160;&#160;&#160;48</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Absolute size of virtual address space. This is 48-bit on AArch64. TODO: might be implementation-specific </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="ad1b7975530599a83d19018b5c39393ef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t kernel_final_byte</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Symbol: End of kernel image. This symbol points to the end address of the kernel image. </p>

</div>
</div>
<a class="anchor" id="ab2b724236109f0e557bf2f9193c62696"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t kernel_first_byte</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Symbol: Start of kernel image. This symbol points to the start address of the kernel image. </p>

</div>
</div>
<a class="anchor" id="acf78a61c4caab267d02668ea46a903ce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uintptr_t kernel_stack</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The kernel stack. </p>
<p>Declared in boot.S. </p>

</div>
</div>
<a class="anchor" id="abcbac8bf86dc4f0699f9329a0d3ed35f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t kernel_text_final_byte</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Symbol: End of kernel image. This symbol points to the end address of the kernel image. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
