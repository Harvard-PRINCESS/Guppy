<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Barrelfish: kernel/arch/x86/startup_x86.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Barrelfish
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_dc43877d82dd332f9fb2071fcca799d6.html">kernel</a></li><li class="navelem"><a class="el" href="dir_4a04b9aac4eefdd334a78e565f4616f2.html">arch</a></li><li class="navelem"><a class="el" href="dir_0ce8714634557e35558d1ff2ffab94d6.html">x86</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">startup_x86.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>x86 kernel bootup code.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a8fbc248b6131e53773c79803e13cd4d2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8fbc248b6131e53773c79803e13cd4d2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="startup__x86_8c.html#a8fbc248b6131e53773c79803e13cd4d2">CNODE</a>(<a class="el" href="structcte.html">cte</a>)&#160;&#160;&#160;get_address(&amp;(<a class="el" href="structcte.html">cte</a>)-&gt;cap)</td></tr>
<tr class="memdesc:a8fbc248b6131e53773c79803e13cd4d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Quick way to find the base address of a cnode capability. <br /></td></tr>
<tr class="separator:a8fbc248b6131e53773c79803e13cd4d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaddf283e11891149ce63e2dd4e62cbbd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="startup__x86_8c.html#aaddf283e11891149ce63e2dd4e62cbbd">BSP_INIT_PROG_NAME</a>&#160;&#160;&#160;&quot;init&quot;</td></tr>
<tr class="separator:aaddf283e11891149ce63e2dd4e62cbbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8ec3d54225aa32f26c2975513d267e88"><td class="memItemLeft" align="right" valign="top">errval_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="startup__x86_8c.html#a8ec3d54225aa32f26c2975513d267e88">startup_alloc_init</a> (void *state, genvaddr_t gvbase, size_t size, uint32_t flags, void **ret)</td></tr>
<tr class="memdesc:a8ec3d54225aa32f26c2975513d267e88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map init user-space memory.  <a href="#a8ec3d54225aa32f26c2975513d267e88">More...</a><br /></td></tr>
<tr class="separator:a8ec3d54225aa32f26c2975513d267e88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a934e861818a2df3cb7e9b7390997117c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a934e861818a2df3cb7e9b7390997117c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="startup__x86_8c.html#a934e861818a2df3cb7e9b7390997117c">create_module_caps</a> (struct spawn_state *st)</td></tr>
<tr class="memdesc:a934e861818a2df3cb7e9b7390997117c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup the module cnode, which contains frame caps to all multiboot modules. <br /></td></tr>
<tr class="separator:a934e861818a2df3cb7e9b7390997117c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea19aa045d2da2ba521d8f9c3c586ca8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aea19aa045d2da2ba521d8f9c3c586ca8"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="startup__x86_8c.html#aea19aa045d2da2ba521d8f9c3c586ca8">kernel_startup_early</a> (void)</td></tr>
<tr class="memdesc:aea19aa045d2da2ba521d8f9c3c586ca8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Kernel's early startup code, called from arch-specific bootstrap. <br /></td></tr>
<tr class="separator:aea19aa045d2da2ba521d8f9c3c586ca8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a4a1b6baf8c45e2efdb77ff958a5b85fc"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structglobal.html">global</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="startup__x86_8c.html#a4a1b6baf8c45e2efdb77ff958a5b85fc">global</a> = &amp;myglobal</td></tr>
<tr class="separator:a4a1b6baf8c45e2efdb77ff958a5b85fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae96910034f8c81f7d29f62c7c16a7170"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="startup__x86_8c.html#ae96910034f8c81f7d29f62c7c16a7170">verbose_dispatch</a></td></tr>
<tr class="memdesc:ae96910034f8c81f7d29f62c7c16a7170"><td class="mdescLeft">&#160;</td><td class="mdescRight">Kernel's main startup code, called from arch-specific bootstrap.  <a href="#ae96910034f8c81f7d29f62c7c16a7170">More...</a><br /></td></tr>
<tr class="separator:ae96910034f8c81f7d29f62c7c16a7170"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>x86 kernel bootup code. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="aaddf283e11891149ce63e2dd4e62cbbd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSP_INIT_PROG_NAME&#160;&#160;&#160;&quot;init&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Name of multiboot module containing program for init domains. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a8ec3d54225aa32f26c2975513d267e88"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">errval_t startup_alloc_init </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">genvaddr_t&#160;</td>
          <td class="paramname"><em>gvbase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>ret</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Map init user-space memory. </p>
<p>This function maps pages of the init user-space module. It expects the virtual base address 'vbase' of a program segment of the init executable, its size 'size' and its ELF64 access control flags. It maps pages into physical memory that is allocated on the fly and puts corresponding frame caps into init's segcn.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vbase</td><td>Virtual base address of program segment. </td></tr>
    <tr><td class="paramname">size</td><td>Size of program segment in bytes. </td></tr>
    <tr><td class="paramname">flags</td><td>ELF64 access control flags of program segment. </td></tr>
    <tr><td class="paramname">ret</td><td>Used to return base region pointer </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a4a1b6baf8c45e2efdb77ff958a5b85fc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structglobal.html">global</a>* <a class="el" href="structglobal.html">global</a> = &amp;myglobal</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Each kernel has a local copy of global and locks. However, during booting and kernel relocation, these are set to point to global of the pristine kernel, so that all the kernels can share it. </p>

</div>
</div>
<a class="anchor" id="ae96910034f8c81f7d29f62c7c16a7170"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool verbose_dispatch</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Kernel's main startup code, called from arch-specific bootstrap. </p>
<p>This function never returns. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
