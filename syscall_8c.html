<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Barrelfish: kernel/syscall.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Barrelfish
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_dc43877d82dd332f9fb2071fcca799d6.html">kernel</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">syscall.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Arch-generic system calls implementation.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7f52dff464d7f9f723c3fe77ee5025ca"><td class="memItemLeft" align="right" valign="top">errval_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="syscall_8c.html#a7f52dff464d7f9f723c3fe77ee5025ca">sys_print</a> (const char *str, size_t length)</td></tr>
<tr class="memdesc:a7f52dff464d7f9f723c3fe77ee5025ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print a string through the kernel.  <a href="#a7f52dff464d7f9f723c3fe77ee5025ca">More...</a><br /></td></tr>
<tr class="separator:a7f52dff464d7f9f723c3fe77ee5025ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1b3abf8190edcc5544ebda0dc21f38e"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structsysret.html">sysret</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="syscall_8c.html#aa1b3abf8190edcc5544ebda0dc21f38e">sys_retype</a> (struct capability *root, capaddr_t source_croot, capaddr_t source_cptr, gensize_t offset, enum objtype type, gensize_t objsize, size_t count, capaddr_t dest_cspace_cptr, capaddr_t dest_cnode_cptr, uint8_t dest_cnode_level, cslot_t dest_slot, bool from_monitor)</td></tr>
<tr class="separator:aa1b3abf8190edcc5544ebda0dc21f38e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af13f3560575e5c27d30c601c4ca5e6b7"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structsysret.html">sysret</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="syscall_8c.html#af13f3560575e5c27d30c601c4ca5e6b7">sys_copy_or_mint</a> (struct capability *root, capaddr_t dest_cspace_cptr, capaddr_t destcn_cptr, cslot_t dest_slot, capaddr_t source_croot_ptr, capaddr_t source_cptr, uint8_t destcn_level, uint8_t source_level, uintptr_t param1, uintptr_t param2, bool mint)</td></tr>
<tr class="separator:af13f3560575e5c27d30c601c4ca5e6b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a559aa67b1e5d12b0337ade2da2c39c32"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structsysret.html">sysret</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="syscall_8c.html#a559aa67b1e5d12b0337ade2da2c39c32">sys_yield</a> (capaddr_t target)</td></tr>
<tr class="memdesc:a559aa67b1e5d12b0337ade2da2c39c32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Yield the CPU.  <a href="#a559aa67b1e5d12b0337ade2da2c39c32">More...</a><br /></td></tr>
<tr class="separator:a559aa67b1e5d12b0337ade2da2c39c32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af00687e7fd2cbd8b24092fc6563b2975"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structsysret.html">sysret</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="syscall_8c.html#af00687e7fd2cbd8b24092fc6563b2975">sys_suspend</a> (bool do_halt)</td></tr>
<tr class="separator:af00687e7fd2cbd8b24092fc6563b2975"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9d57378fae1f8013371865727935f64"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structsysret.html">sysret</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="syscall_8c.html#ac9d57378fae1f8013371865727935f64">sys_idcap_identify</a> (struct capability *cap, idcap_id_t *id)</td></tr>
<tr class="separator:ac9d57378fae1f8013371865727935f64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85942a8b8c5072c3117d80a9d490ce5a"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structsysret.html">sysret</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="syscall_8c.html#a85942a8b8c5072c3117d80a9d490ce5a">sys_monitor_spawn_core</a> (hwid_t target, enum cpu_type cpu_type, genvaddr_t entry, genpaddr_t context)</td></tr>
<tr class="separator:a85942a8b8c5072c3117d80a9d490ce5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75a713e7478762e45e3bd63ea92b963a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a75a713e7478762e45e3bd63ea92b963a"></a>
struct <a class="el" href="structsysret.html">sysret</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="syscall_8c.html#a75a713e7478762e45e3bd63ea92b963a">sys_get_absolute_time</a> (void)</td></tr>
<tr class="memdesc:a75a713e7478762e45e3bd63ea92b963a"><td class="mdescLeft">&#160;</td><td class="mdescRight">get time elapsed (in milliseconds) since system boot. <br /></td></tr>
<tr class="separator:a75a713e7478762e45e3bd63ea92b963a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Arch-generic system calls implementation. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="af13f3560575e5c27d30c601c4ca5e6b7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structsysret.html">sysret</a> sys_copy_or_mint </td>
          <td>(</td>
          <td class="paramtype">struct capability *&#160;</td>
          <td class="paramname"><em>root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">capaddr_t&#160;</td>
          <td class="paramname"><em>dest_cspace_cptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">capaddr_t&#160;</td>
          <td class="paramname"><em>destcn_cptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cslot_t&#160;</td>
          <td class="paramname"><em>dest_slot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">capaddr_t&#160;</td>
          <td class="paramname"><em>source_croot_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">capaddr_t&#160;</td>
          <td class="paramname"><em>source_cptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>destcn_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>source_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>param1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>param2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>mint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Common code for copying and minting except the mint flag and param passing</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">root</td><td>Source cspace root cnode </td></tr>
    <tr><td class="paramname">dest_cspace_cptr</td><td>Destination cspace root cnode cptr in source cspace  destcn_cptr Destination cnode cptr relative to destination cspace </td></tr>
    <tr><td class="paramname">dest_slot</td><td>Destination slot </td></tr>
    <tr><td class="paramname">source_cptr</td><td>Source capability cptr relative to source cspace </td></tr>
    <tr><td class="paramname">destcn_level</td><td>Level/depth of destination cnode </td></tr>
    <tr><td class="paramname">source_level</td><td>Level/depth of source cap </td></tr>
    <tr><td class="paramname">param1</td><td>First parameter for mint </td></tr>
    <tr><td class="paramname">param2</td><td>Second parameter for mint </td></tr>
    <tr><td class="paramname">mint</td><td>Call is a minting operation </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac9d57378fae1f8013371865727935f64"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structsysret.html">sysret</a> sys_idcap_identify </td>
          <td>(</td>
          <td class="paramtype">struct capability *&#160;</td>
          <td class="paramname"><em>cap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">idcap_id_t *&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The format of the returned ID is: </p><hr/>
 <h2>| 0 (unused) | coreid | core_local_id | </h2>
<p>63 39 31 0 Bit </p>

</div>
</div>
<a class="anchor" id="a85942a8b8c5072c3117d80a9d490ce5a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structsysret.html">sysret</a> sys_monitor_spawn_core </td>
          <td>(</td>
          <td class="paramtype">hwid_t&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum cpu_type cpu_type&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">genvaddr_t&#160;</td>
          <td class="paramname"><em>entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">genpaddr_t&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calls correct handler function to spawn an app core.</p>
<p>At the moment spawn_core_handlers is set-up per architecture inside text_init() usually found in init.c.</p>
<dl class="section note"><dt>Note</dt><dd>Generally the x86 terms of BSP and APP core are used throughout Barrelfish to distinguish between bootstrap core (BSP) and application cores (APP).</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">core_id</td><td>Identifier of the core which we want to boot </td></tr>
    <tr><td class="paramname">cpu_type</td><td>Architecture of the core. </td></tr>
    <tr><td class="paramname">entry</td><td>Entry point for code to start execution.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">SYS_ERR_OK</td><td>Core successfully booted. </td></tr>
    <tr><td class="paramname">SYS_ERR_ARCHITECTURE_NOT_SUPPORTED</td><td>No handler registered for the specified cpu_type. </td></tr>
    <tr><td class="paramname">SYS_ERR_CORE_NOT_FOUND</td><td>Core failed to boot. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a7f52dff464d7f9f723c3fe77ee5025ca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">errval_t sys_print </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print a string through the kernel. </p>
<p>This calls <a class="el" href="kpi_2syscalls_8h.html#a1da74c673926547ee7da96050b6c736b" title="Write to console. ">SYSCALL_PRINT</a> to print 'string' of length 'length' through the kernel. Whether and where 'string' is printed is determined by the kernel.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">string</td><td>Pointer to string to print. </td></tr>
    <tr><td class="paramname">length</td><td>Length of string.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Syscall error code (#SYS_ERR_OK on success). </dd></dl>

</div>
</div>
<a class="anchor" id="aa1b3abf8190edcc5544ebda0dc21f38e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structsysret.html">sysret</a> sys_retype </td>
          <td>(</td>
          <td class="paramtype">struct capability *&#160;</td>
          <td class="paramname"><em>root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">capaddr_t&#160;</td>
          <td class="paramname"><em>source_croot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">capaddr_t&#160;</td>
          <td class="paramname"><em>source_cptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gensize_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum objtype&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gensize_t&#160;</td>
          <td class="paramname"><em>objsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">capaddr_t&#160;</td>
          <td class="paramname"><em>dest_cspace_cptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">capaddr_t&#160;</td>
          <td class="paramname"><em>dest_cnode_cptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>dest_cnode_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cslot_t&#160;</td>
          <td class="paramname"><em>dest_slot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>from_monitor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">root</td><td>Source CSpace root cnode to invoke </td></tr>
    <tr><td class="paramname">source_croot</td><td>Source capability cspace root </td></tr>
    <tr><td class="paramname">source_cptr</td><td>Source capability cptr </td></tr>
    <tr><td class="paramname">offset</td><td>Offset into source capability from which to retype </td></tr>
    <tr><td class="paramname">type</td><td>Type to retype to </td></tr>
    <tr><td class="paramname">objsize</td><td>Object size for variable-sized types </td></tr>
    <tr><td class="paramname">count</td><td>number of objects to create </td></tr>
    <tr><td class="paramname">dest_cspace_cptr</td><td>Destination CSpace cnode cptr relative to source cspace root </td></tr>
    <tr><td class="paramname">dest_cnode_cptr</td><td>Destination cnode cptr </td></tr>
    <tr><td class="paramname">dest_slot</td><td>Destination slot number </td></tr>
    <tr><td class="paramname">dest_cnode_level</td><td>Level/depth of destination cnode </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af00687e7fd2cbd8b24092fc6563b2975"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structsysret.html">sysret</a> sys_suspend </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>halt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Suspend the current cpu </p>

</div>
</div>
<a class="anchor" id="a559aa67b1e5d12b0337ade2da2c39c32"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structsysret.html">sysret</a> sys_yield </td>
          <td>(</td>
          <td class="paramtype">capaddr_t&#160;</td>
          <td class="paramname"><em>target</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Yield the CPU. </p>
<p>Yields the remainder of the time-slice for this dispatcher to the next runnable dispatcher.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target</td><td>Dispatcher to yield to, or CPTR_NULL for an undirected yield</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Syscall error code (#SYS_ERR_OK on success). </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
