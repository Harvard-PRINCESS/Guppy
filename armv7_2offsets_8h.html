<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Barrelfish: kernel/include/arch/armv7/offsets.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Barrelfish
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_dc43877d82dd332f9fb2071fcca799d6.html">kernel</a></li><li class="navelem"><a class="el" href="dir_009f605b833ac4622acd6c3c0c26c0f0.html">include</a></li><li class="navelem"><a class="el" href="dir_b938bbc65f66dd090a6a00a71c65b7d8.html">arch</a></li><li class="navelem"><a class="el" href="dir_65cb4de5a52f274b32ea5bf529ab78dc.html">armv7</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">offsets.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>ARMv7-A address space sizes and offsets.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aaffaca57c7c58481e0360343694a3231"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv7_2offsets_8h.html#aaffaca57c7c58481e0360343694a3231">GEN_ADDR</a>(bits)&#160;&#160;&#160;(((genpaddr_t)1) &lt;&lt; bits)</td></tr>
<tr class="separator:aaffaca57c7c58481e0360343694a3231"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7665375ee0a42e5d89ebb455dfbf272"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv7_2offsets_8h.html#ae7665375ee0a42e5d89ebb455dfbf272">VADDR_SPACE_SIZE</a>&#160;&#160;&#160;<a class="el" href="armv7_2offsets_8h.html#aaffaca57c7c58481e0360343694a3231">GEN_ADDR</a>(32);</td></tr>
<tr class="separator:ae7665375ee0a42e5d89ebb455dfbf272"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9e9cbc1a6eccc96e44e7509068bfbb3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv7_2offsets_8h.html#ae9e9cbc1a6eccc96e44e7509068bfbb3">PADDR_SPACE_SIZE</a>&#160;&#160;&#160;<a class="el" href="armv7_2offsets_8h.html#aaffaca57c7c58481e0360343694a3231">GEN_ADDR</a>(32)</td></tr>
<tr class="separator:ae9e9cbc1a6eccc96e44e7509068bfbb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40c0ab0a0a092f7fd208481a82cb5cf8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv7_2offsets_8h.html#a40c0ab0a0a092f7fd208481a82cb5cf8">PADDR_SPACE_LIMIT</a>&#160;&#160;&#160;(<a class="el" href="armv7_2offsets_8h.html#ae9e9cbc1a6eccc96e44e7509068bfbb3">PADDR_SPACE_SIZE</a> - 1)</td></tr>
<tr class="separator:a40c0ab0a0a092f7fd208481a82cb5cf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5fcf7c72c32a9cf48bee567d098a90b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv7_2offsets_8h.html#ae5fcf7c72c32a9cf48bee567d098a90b">RAM_WINDOW_SIZE</a>&#160;&#160;&#160;<a class="el" href="armv7_2offsets_8h.html#aaffaca57c7c58481e0360343694a3231">GEN_ADDR</a>(30)</td></tr>
<tr class="separator:ae5fcf7c72c32a9cf48bee567d098a90b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55d0c3475cc452ccbd6e0c8dd1c68bd7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv7_2offsets_8h.html#a55d0c3475cc452ccbd6e0c8dd1c68bd7">KERNEL_OFFSET</a>&#160;&#160;&#160;0x80000000</td></tr>
<tr class="separator:a55d0c3475cc452ccbd6e0c8dd1c68bd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0db911257280e7a2fd379bd41f7a12f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv7_2offsets_8h.html#ac0db911257280e7a2fd379bd41f7a12f">INIT_SPACE_LIMIT</a>&#160;&#160;&#160;(32 * 1024 * 1024)</td></tr>
<tr class="separator:ac0db911257280e7a2fd379bd41f7a12f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca7f6747963602b40a39593808ca99c7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv7_2offsets_8h.html#aca7f6747963602b40a39593808ca99c7">INIT_VBASE</a>&#160;&#160;&#160;(2 * 1024 * 1024)</td></tr>
<tr class="separator:aca7f6747963602b40a39593808ca99c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6de30a7372a6e758a79c361d0ee2618"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv7_2offsets_8h.html#ab6de30a7372a6e758a79c361d0ee2618">MEMORY_OFFSET</a>&#160;&#160;&#160;<a class="el" href="armv7_2offsets_8h.html#aaffaca57c7c58481e0360343694a3231">GEN_ADDR</a>(31)</td></tr>
<tr class="separator:ab6de30a7372a6e758a79c361d0ee2618"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebe5fc757c4b18f87d96c40ba50b41e6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv7_2offsets_8h.html#aebe5fc757c4b18f87d96c40ba50b41e6">VECTORS_BASE</a>&#160;&#160;&#160;0xffff0000</td></tr>
<tr class="separator:aebe5fc757c4b18f87d96c40ba50b41e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77383d4c5311d4c7fe49364766887650"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv7_2offsets_8h.html#a77383d4c5311d4c7fe49364766887650">KERNEL_STACK_SIZE</a>&#160;&#160;&#160;0x4000</td></tr>
<tr class="separator:a77383d4c5311d4c7fe49364766887650"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70631ee9cd22ec392f685b4b22e0c0d7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv7_2offsets_8h.html#a70631ee9cd22ec392f685b4b22e0c0d7">INT_HANDLER_TABLE</a>&#160;&#160;&#160;0xFFFF0100</td></tr>
<tr class="separator:a70631ee9cd22ec392f685b4b22e0c0d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa674fb621d25b61121d6253264c350d4"><td class="memItemLeft" align="right" valign="top">lpaddr_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv7_2offsets_8h.html#aa674fb621d25b61121d6253264c350d4">phys_memory_start</a></td></tr>
<tr class="separator:aa674fb621d25b61121d6253264c350d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2b724236109f0e557bf2f9193c62696"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv7_2offsets_8h.html#ab2b724236109f0e557bf2f9193c62696">kernel_first_byte</a></td></tr>
<tr class="separator:ab2b724236109f0e557bf2f9193c62696"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcbac8bf86dc4f0699f9329a0d3ed35f"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv7_2offsets_8h.html#abcbac8bf86dc4f0699f9329a0d3ed35f">kernel_text_final_byte</a></td></tr>
<tr class="separator:abcbac8bf86dc4f0699f9329a0d3ed35f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1b7975530599a83d19018b5c39393ef"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv7_2offsets_8h.html#ad1b7975530599a83d19018b5c39393ef">kernel_final_byte</a></td></tr>
<tr class="separator:ad1b7975530599a83d19018b5c39393ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44cd88c61b36172c6e2702a860167d85"><td class="memItemLeft" align="right" valign="top">uintptr_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="armv7_2offsets_8h.html#a44cd88c61b36172c6e2702a860167d85">kernel_stack</a> [<a class="el" href="armv8_2offsets_8h.html#a77383d4c5311d4c7fe49364766887650">KERNEL_STACK_SIZE</a>/sizeof(uintptr_t)]</td></tr>
<tr class="memdesc:a44cd88c61b36172c6e2702a860167d85"><td class="mdescLeft">&#160;</td><td class="mdescRight">The kernel stack.  <a href="#a44cd88c61b36172c6e2702a860167d85">More...</a><br /></td></tr>
<tr class="separator:a44cd88c61b36172c6e2702a860167d85"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>ARMv7-A address space sizes and offsets. </p>
<p>The layout of the ARM virtual address space can be summarized as follows:</p>
<p>User-space maps user-space programs. Physical memory maps all available physical memory (up to PADDR_SPACE_LIMIT). Kernel-space maps only the kernel text and data.</p>
<p>This partition is static and can only be changed at compile-time. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="aaffaca57c7c58481e0360343694a3231"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GEN_ADDR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">bits</td><td>)</td>
          <td>&#160;&#160;&#160;(((genpaddr_t)1) &lt;&lt; bits)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="armv7_2offsets_8h.html#aaffaca57c7c58481e0360343694a3231">GEN_ADDR(bits)</a> gives the size of address space possible with &lt;bits&gt; bits. </p>

</div>
</div>
<a class="anchor" id="ac0db911257280e7a2fd379bd41f7a12f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INIT_SPACE_LIMIT&#160;&#160;&#160;(32 * 1024 * 1024)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Static address space limit for the init user-space domain. The static space is used to map in code and static data of the init module, as well as all loaded multiboot modules. init can freely allocate dynamic memory as soon as it is running. This is 32 MBytes right now.</p>
<p>You should make this constant a multiple of #BASE_PAGE_SIZE * #PTABLE_SIZE or you'll restrict init's static address space unneccessarily. init's lowest segment should also be based at these multiples or it restricts itself.</p>
<p>NB 32MB is size of the fast context switch extension per-process address space. </p>

</div>
</div>
<a class="anchor" id="aca7f6747963602b40a39593808ca99c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INIT_VBASE&#160;&#160;&#160;(2 * 1024 * 1024)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Base address of init address space in virtual memory. init should start at 4 MByte. The kernel maps in important structures at 2 MByte. This address should be page-table size aligned (i.e. with 4 KByte pages, a page table maps 2 MBytes. Thus, align it to multiples of 2 MBytes). </p>

</div>
</div>
<a class="anchor" id="a70631ee9cd22ec392f685b4b22e0c0d7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INT_HANDLER_TABLE&#160;&#160;&#160;0xFFFF0100</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Kernel interrupt jump table </p>

</div>
</div>
<a class="anchor" id="a55d0c3475cc452ccbd6e0c8dd1c68bd7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KERNEL_OFFSET&#160;&#160;&#160;0x80000000</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Kernel offset - the kernel window is mapped by TTBR1, from 2GB. </p>

</div>
</div>
<a class="anchor" id="a77383d4c5311d4c7fe49364766887650"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KERNEL_STACK_SIZE&#160;&#160;&#160;0x4000</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Kernel stack size &ndash; 16KB </p>

</div>
</div>
<a class="anchor" id="ab6de30a7372a6e758a79c361d0ee2618"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MEMORY_OFFSET&#160;&#160;&#160;<a class="el" href="armv7_2offsets_8h.html#aaffaca57c7c58481e0360343694a3231">GEN_ADDR</a>(31)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Absolute offset of mapped physical memory within virtual address space. Just to clarify, this means that RAM will be mapped into kernel virtual address space at this address (i.e. 2GB.). </p>

</div>
</div>
<a class="anchor" id="a40c0ab0a0a092f7fd208481a82cb5cf8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PADDR_SPACE_LIMIT&#160;&#160;&#160;(<a class="el" href="armv7_2offsets_8h.html#ae9e9cbc1a6eccc96e44e7509068bfbb3">PADDR_SPACE_SIZE</a> - 1)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Maximum physical address space mappable by the kernel. Adjust this for a bigger physical address space. </p>

</div>
</div>
<a class="anchor" id="ae9e9cbc1a6eccc96e44e7509068bfbb3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PADDR_SPACE_SIZE&#160;&#160;&#160;<a class="el" href="armv7_2offsets_8h.html#aaffaca57c7c58481e0360343694a3231">GEN_ADDR</a>(32)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Absolute size of physical address space. </p>

</div>
</div>
<a class="anchor" id="ae5fcf7c72c32a9cf48bee567d098a90b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RAM_WINDOW_SIZE&#160;&#160;&#160;<a class="el" href="armv7_2offsets_8h.html#aaffaca57c7c58481e0360343694a3231">GEN_ADDR</a>(30)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The size of the kernel's RAM window. </p>

</div>
</div>
<a class="anchor" id="ae7665375ee0a42e5d89ebb455dfbf272"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VADDR_SPACE_SIZE&#160;&#160;&#160;<a class="el" href="armv7_2offsets_8h.html#aaffaca57c7c58481e0360343694a3231">GEN_ADDR</a>(32);</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Absolute size of virtual address space. This is 32-bit on ARM. </p>

</div>
</div>
<a class="anchor" id="aebe5fc757c4b18f87d96c40ba50b41e6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VECTORS_BASE&#160;&#160;&#160;0xffff0000</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The high exception vector address </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="ad1b7975530599a83d19018b5c39393ef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t kernel_final_byte</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Symbol: End of kernel image. This symbol points to the end address of the kernel image. </p>

</div>
</div>
<a class="anchor" id="ab2b724236109f0e557bf2f9193c62696"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t kernel_first_byte</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Symbol: Start of kernel image. This symbol points to the start address of the kernel image. </p>

</div>
</div>
<a class="anchor" id="a44cd88c61b36172c6e2702a860167d85"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uintptr_t kernel_stack[<a class="el" href="armv8_2offsets_8h.html#a77383d4c5311d4c7fe49364766887650">KERNEL_STACK_SIZE</a>/sizeof(uintptr_t)]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The kernel stack. </p>
<p>Declared in boot.S. </p>

</div>
</div>
<a class="anchor" id="abcbac8bf86dc4f0699f9329a0d3ed35f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t kernel_text_final_byte</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Symbol: End of kernel image. This symbol points to the end address of the kernel image. </p>

</div>
</div>
<a class="anchor" id="aa674fb621d25b61121d6253264c350d4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">lpaddr_t phys_memory_start</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Absolute start of RAM in physical memory. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
