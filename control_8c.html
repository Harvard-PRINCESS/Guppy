<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Barrelfish: lib/trace/control.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Barrelfish
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_ce83135422dbf89e624d405998b5c2d4.html">trace</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">control.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>System-wide tracing.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae9fca21c96d9c3b1b85ce14d77339b31"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#ae9fca21c96d9c3b1b85ce14d77339b31">trace_reset_buffer</a> (void)</td></tr>
<tr class="memdesc:ae9fca21c96d9c3b1b85ce14d77339b31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the trace buffer on the current core.  <a href="#ae9fca21c96d9c3b1b85ce14d77339b31">More...</a><br /></td></tr>
<tr class="separator:ae9fca21c96d9c3b1b85ce14d77339b31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a8bba8b0e3a9e25224d452350a22278"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a2a8bba8b0e3a9e25224d452350a22278">trace_reset_all</a> (void)</td></tr>
<tr class="memdesc:a2a8bba8b0e3a9e25224d452350a22278"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset all trace buffers discarding the current trace.  <a href="#a2a8bba8b0e3a9e25224d452350a22278">More...</a><br /></td></tr>
<tr class="separator:a2a8bba8b0e3a9e25224d452350a22278"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91e10b57faa8a2720a0eb6eab50653c4"><td class="memItemLeft" align="right" valign="top">errval_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a91e10b57faa8a2720a0eb6eab50653c4">trace_control</a> (uint64_t start_trigger, uint64_t stop_trigger, uint64_t duration)</td></tr>
<tr class="memdesc:a91e10b57faa8a2720a0eb6eab50653c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specify the trigger events which start and stop tracing.  <a href="#a91e10b57faa8a2720a0eb6eab50653c4">More...</a><br /></td></tr>
<tr class="separator:a91e10b57faa8a2720a0eb6eab50653c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1554da0455e0ad0b4fb6acfdd7dafcf6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1554da0455e0ad0b4fb6acfdd7dafcf6"></a>
errval_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a1554da0455e0ad0b4fb6acfdd7dafcf6">trace_wait</a> (void)</td></tr>
<tr class="memdesc:a1554da0455e0ad0b4fb6acfdd7dafcf6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait for a trace to complete. <br /></td></tr>
<tr class="separator:a1554da0455e0ad0b4fb6acfdd7dafcf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c9b34fad7f11e1561f55d92581bc9ef"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a2c9b34fad7f11e1561f55d92581bc9ef">trace_dump</a> (char *buf, size_t buflen, int *number_of_events_dumped)</td></tr>
<tr class="memdesc:a2c9b34fad7f11e1561f55d92581bc9ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dump the contents of the trace buffers.  <a href="#a2c9b34fad7f11e1561f55d92581bc9ef">More...</a><br /></td></tr>
<tr class="separator:a2c9b34fad7f11e1561f55d92581bc9ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74d6ae6e207559ad7dc709899f2cac96"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a74d6ae6e207559ad7dc709899f2cac96">trace_flush</a> (struct event_closure callback)</td></tr>
<tr class="memdesc:a74d6ae6e207559ad7dc709899f2cac96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flush the trace buffer to the "best" destination.  <a href="#a74d6ae6e207559ad7dc709899f2cac96">More...</a><br /></td></tr>
<tr class="separator:a74d6ae6e207559ad7dc709899f2cac96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d37ad0119d030706672d6499cdddda2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a1d37ad0119d030706672d6499cdddda2">trace_set_autoflush</a> (bool enabled)</td></tr>
<tr class="memdesc:a1d37ad0119d030706672d6499cdddda2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable/Disable the autoflush mechanism of the tracing framework.  <a href="#a1d37ad0119d030706672d6499cdddda2">More...</a><br /></td></tr>
<tr class="separator:a1d37ad0119d030706672d6499cdddda2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c64757872bf379366b3d94fbf9b88aa"><td class="memItemLeft" align="right" valign="top">errval_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a2c64757872bf379366b3d94fbf9b88aa">trace_set_subsys_enabled</a> (uint16_t subsys, bool enabled)</td></tr>
<tr class="memdesc:a2c64757872bf379366b3d94fbf9b88aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable/Disable the logging of a given subsytem.  <a href="#a2c64757872bf379366b3d94fbf9b88aa">More...</a><br /></td></tr>
<tr class="separator:a2c64757872bf379366b3d94fbf9b88aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62de5ea5abf841d7fb64333764d7f424"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a62de5ea5abf841d7fb64333764d7f424"></a>
errval_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a62de5ea5abf841d7fb64333764d7f424">trace_set_all_subsys_enabled</a> (bool enabled)</td></tr>
<tr class="memdesc:a62de5ea5abf841d7fb64333764d7f424"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable/Disable all subsystems. <br /></td></tr>
<tr class="separator:a62de5ea5abf841d7fb64333764d7f424"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b6850fb49ec0f54f2a0c9a3d1b58dd2"><td class="memItemLeft" align="right" valign="top">errval_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a2b6850fb49ec0f54f2a0c9a3d1b58dd2">trace_prepare</a> (struct event_closure callback)</td></tr>
<tr class="memdesc:a2b6850fb49ec0f54f2a0c9a3d1b58dd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Optional call to do "extra" preparation of the tracing framework.  <a href="#a2b6850fb49ec0f54f2a0c9a3d1b58dd2">More...</a><br /></td></tr>
<tr class="separator:a2b6850fb49ec0f54f2a0c9a3d1b58dd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>System-wide tracing. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a91e10b57faa8a2720a0eb6eab50653c4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">errval_t trace_control </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>start_trigger</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>stop_trigger</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>duration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Specify the trigger events which start and stop tracing. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">start_trigger</td><td>- Raw event value which starts the trace </td></tr>
    <tr><td class="paramname">stop_trigger</td><td>- Raw event value which stops the trace </td></tr>
    <tr><td class="paramname">duration</td><td>- Maximum trace duration in cycles (0 is infinite) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2c9b34fad7f11e1561f55d92581bc9ef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t trace_dump </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>buflen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>number_of_events_dumped</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dump the contents of the trace buffers. </p>
<p>buf : The buffer to write the trace log into. buflen : Length of buf. number_of_events_dumped : (optional) Returns how many events have been written into the buffer. </p>

</div>
</div>
<a class="anchor" id="a74d6ae6e207559ad7dc709899f2cac96"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trace_flush </td>
          <td>(</td>
          <td class="paramtype">struct event_closure&#160;</td>
          <td class="paramname"><em>callback</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flush the trace buffer to the "best" destination. </p>
<p>This function automatically determines if bfscope is running and if someone is connected over the network. If so, the buffer is flushed over the network. If nobody is connected or bfscope is not running, the buffer is flushed onto the console. </p>

</div>
</div>
<a class="anchor" id="a2b6850fb49ec0f54f2a0c9a3d1b58dd2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">errval_t trace_prepare </td>
          <td>(</td>
          <td class="paramtype">struct event_closure&#160;</td>
          <td class="paramname"><em>callback</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Optional call to do "extra" preparation of the tracing framework. </p>
<p>Call this method to prepare for tracing. This is not a preparation in a strict sense, i.e. tracing will also work when you do not call this method, but it provides some benefits.</p>
<p>Currently it provides a mechanism for clock synchronization between cores. </p>

</div>
</div>
<a class="anchor" id="a2a8bba8b0e3a9e25224d452350a22278"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trace_reset_all </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset all trace buffers discarding the current trace. </p>
<p>Reset head and tail pointers. </p>

</div>
</div>
<a class="anchor" id="ae9fca21c96d9c3b1b85ce14d77339b31"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trace_reset_buffer </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset the trace buffer on the current core. </p>
<p>Reset head and tail pointers. </p>

</div>
</div>
<a class="anchor" id="a1d37ad0119d030706672d6499cdddda2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trace_set_autoflush </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>enabled</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enable/Disable the autoflush mechanism of the tracing framework. </p>
<p>If autoflush is enabled, the tracing framework will automatically flush the content of the buffer periodically.</p>
<p>NOTE: This only works when bfscope is running!</p>
<p>NOTE: If you enable autoflush, it will affect your performance during the time period you are flushing, as the buffer might be flushed at any given time. </p>

</div>
</div>
<a class="anchor" id="a2c64757872bf379366b3d94fbf9b88aa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">errval_t trace_set_subsys_enabled </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>subsys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>enabled</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enable/Disable the logging of a given subsytem. </p>
<p>subsys: A subsystem, i.e. the macro generated by the DSL. enabled: True iff the events should be logged. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
